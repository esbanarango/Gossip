<% publish_to "/rooms/#{@room.id}" do %>

  var elems = $("#liUsers a"), count = elems.length;
  //Hide the user and then remove it form the DOM	
  var id = <%= @user.id%>
  $("a.user_"+id).each(function(){
  		$("#private_message_"+id).slideUp("fast",function(){
  			$(this).remove();
  		});
	  	$(this).slideUp("fast",function(){
	  		$(this).remove();
	  		//Decrease the number of users in the room
	  		if (count==0) $("#num-users").text($("#liUsers a").size());
	  	});
	});
  
<% end %>

<% publish_to "/rooms/#{@room.id}" do %>
	setTimeout("$('#num-users').text($('#liUsers a').size())",500);
	setTimeout("$('#num-users').text($('#liUsers a').size())",1000);
	setTimeout("$('#num-users').text($('#liUsers a').size())",1500);
<% end %>